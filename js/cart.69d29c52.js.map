{"version":3,"sources":["webpack:///./src/views/Cart.vue?c461","webpack:///src/views/Cart.vue","webpack:///./src/views/Cart.vue?8aa5","webpack:///./src/views/Cart.vue"],"names":["render","_vm","this","_h","$createElement","_c","_self","_v","_s","total","attrs","products","length","on","checkout","headers","rowClass","scopedSlots","_u","key","fn","ref","item","product","image","price","staticStyle","qrule","$event","quantity","updateCart","_id","model","value","callback","$$v","$set","_n","expression","sell","_e","staticRenderFns","data","text","align","sortable","methods","name","id","index","authorization","icon","title","type","computed","reduce","accumulator","currentValue","created","component","VBtn","VContainer","VDataTable","VForm","VImg","VSubheader","VTextField"],"mappings":"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","file":"js/cart.69d29c52.js","sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('v-container',[_c('h1',[_vm._v(\"總金額 \"+_vm._s(_vm.total))]),_c('v-btn',{attrs:{\"disabled\":_vm.products.length === 0},on:{\"click\":_vm.checkout}},[_vm._v(\"結帳\")]),_c('v-data-table',{attrs:{\"headers\":_vm.headers,\"items\":_vm.products,\"items-per-page\":5,\"item-class\":_vm.rowClass},scopedSlots:_vm._u([{key:\"item.product.image\",fn:function(ref){\nvar item = ref.item;\nreturn [_c('v-img',{attrs:{\"src\":item.product.image,\"height\":\"60\",\"width\":\"100\",\"contain\":\"\"}})]}},{key:\"item.product.price\",fn:function(ref){\nvar item = ref.item;\nreturn [_c('v-subheader',[_vm._v(\" $ \"+_vm._s(item.product.price)+\" \")])]}},{key:\"item.quantity\",fn:function(ref){\nvar item = ref.item;\nreturn [_c('v-form',[_c('v-text-field',{staticStyle:{\"width\":\"140px\"},attrs:{\"readonly\":\"\",\"dense\":\"\",\"width\":\"20\",\"type\":\"number\",\"min\":\"10\",\"rules\":_vm.qrule,\"hide-spin-buttons\":\"\",\"outlined\":\"\",\"append-icon\":\"mdi-plus\",\"prepend-inner-icon\":\"mdi-minus\"},on:{\"click:append\":function($event){item.quantity++;_vm.updateCart(item._id, item.quantity)},\"click:prepend-inner\":function($event){item.quantity > 0 ? item.quantity-- : null;_vm.updateCart(item._id, item.quantity)},\"input\":function($event){return _vm.updateCart(item._id, item.quantity)}},model:{value:(item.quantity),callback:function ($$v) {_vm.$set(item, \"quantity\", _vm._n($$v))},expression:\"item.quantity\"}}),_c('v-btn',{attrs:{\"color\":\"error\"},on:{\"click\":function($event){return _vm.updateCart(item._id, 0)}}},[_vm._v(\" 刪除\")]),(!item.product.sell)?_c('h2',[_vm._v(\"商品已下架\")]):_vm._e()],1)]}}])})],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n<v-container>\n  <h1>總金額 {{ total }}</h1>\n  <v-btn @click='checkout' :disabled='products.length === 0'>結帳</v-btn>\n  <v-data-table\n    :headers=\"headers\"\n    :items=\"products\"\n    :items-per-page=\"5\"\n    :item-class='rowClass'>\n        <template #item.product.image=\"{ item }\">\n                <v-img :src='item.product.image' height='60' width='100' contain></v-img>\n        </template>\n        <template #item.product.price=\"{ item }\">\n                <v-subheader>\n                $ {{ item.product.price }}\n                </v-subheader>\n        </template>\n        <template #item.quantity=\"{ item }\">\n                <v-form>\n                        <v-text-field\n                          readonly\n                          dense\n                          width='20'\n                          type='number'\n                          v-model.number='item.quantity'\n                          min='10'\n                          :rules='qrule'\n                          hide-spin-buttons\n                          outlined\n                          append-icon='mdi-plus'\n                          prepend-inner-icon='mdi-minus'\n                          @click:append='item.quantity++;updateCart(item._id, item.quantity)'\n                          @click:prepend-inner='item.quantity > 0 ? item.quantity-- : null;updateCart(item._id, item.quantity)'\n                          @input='updateCart(item._id, item.quantity)'\n                          style='width: 140px'\n                        >\n\n                        </v-text-field>\n                        <v-btn color='error' @click='updateCart(item._id, 0)'> 刪除</v-btn>\n                        <h2 v-if='!item.product.sell'>商品已下架</h2>\n                </v-form>\n        </template>\n    </v-data-table>\n</v-container>\n</template>\n\n<script>\nexport default {\n  data () {\n    return {\n      headers: [\n        {\n          text: '圖片',\n          align: 'start',\n          sortable: false,\n          value: 'product.image'\n        },\n        {\n          text: '商品',\n          sortable: false,\n          value: 'product.name'\n        },\n        { text: '價格', value: 'product.price' },\n        { text: '操作', value: 'quantity' }\n      ],\n      products: [],\n      qrule: [\n        v => v > 0 || '數量必須大於 0',\n        v => !!v || '必填項目'\n      ]\n    }\n  },\n  methods: {\n    name: 'Cart',\n    async updateCart (id, quantity) {\n      try {\n        const index = this.products.map(item => item._id).indexOf(id)\n        await this.api.patch('/users/me/cart',\n          { product: this.products[index].product._id, quantity },\n          {\n            headers: {\n              authorization: 'Bearer ' + this.user.token\n            }\n          }\n        )\n        if (quantity === 0) {\n          this.products.splice(index, 1)\n          this.$store.commit('user/updateCart', this.user.cart - 1)\n        }\n      } catch (error) {\n        this.$swal({\n          icon: 'error',\n          title: '失敗',\n          text: '修改購物車失敗'\n        })\n      }\n    },\n    async checkout () {\n      try {\n        await this.api.post('/orders', {}, {\n          headers: {\n            authorization: 'Bearer ' + this.user.token\n          }\n        })\n        this.$router.push('/orders')\n        this.$store.commit('user/updateCart', 0)\n      } catch (error) {\n        this.$swal({\n          icon: 'error',\n          title: '失敗',\n          text: '結帳失敗'\n        })\n      }\n    },\n    rowClass (item, type) {\n      return !item.product.sell ? 'error' : ''\n    }\n  },\n  computed: {\n    total () {\n      return this.products.reduce((accumulator, currentValue) => {\n        return accumulator + currentValue.quantity * currentValue.product.price\n      }, 0)\n    }\n  },\n  async created () {\n    try {\n      const { data } = await this.api.get('/users/me/cart', {\n        headers: {\n          authorization: 'Bearer ' + this.user.token\n        }\n      })\n      this.products = data.result\n    } catch (error) {\n      this.$swal({\n        icon: 'error',\n        title: '失敗',\n        text: '取得購物車失敗'\n      })\n    }\n  }\n}\n</script>\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Cart.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Cart.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Cart.vue?vue&type=template&id=5df24930&\"\nimport script from \"./Cart.vue?vue&type=script&lang=js&\"\nexport * from \"./Cart.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports\n\n/* vuetify-loader */\nimport installComponents from \"!../../node_modules/vuetify-loader/lib/runtime/installComponents.js\"\nimport { VBtn } from 'vuetify/lib/components/VBtn';\nimport { VContainer } from 'vuetify/lib/components/VGrid';\nimport { VDataTable } from 'vuetify/lib/components/VDataTable';\nimport { VForm } from 'vuetify/lib/components/VForm';\nimport { VImg } from 'vuetify/lib/components/VImg';\nimport { VSubheader } from 'vuetify/lib/components/VSubheader';\nimport { VTextField } from 'vuetify/lib/components/VTextField';\ninstallComponents(component, {VBtn,VContainer,VDataTable,VForm,VImg,VSubheader,VTextField})\n"],"sourceRoot":""}